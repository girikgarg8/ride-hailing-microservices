# =============================================================================
# UBER ENTITY SERVICE - PRODUCTION CONFIGURATION
# =============================================================================
# This file contains AWS production-specific configurations that override
# the default application.properties when running with --spring.profiles.active=prod

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# AWS RDS MySQL connection - uses environment variables for security
# Why needed: Production database is on AWS RDS, not localhost
spring.datasource.url=jdbc:mysql://${RDS_ENDPOINT}:3306/Uber_Db_Prod
spring.datasource.username=${RDS_USERNAME}
spring.datasource.password=${RDS_PASSWORD}

# =============================================================================
# SERVICE DISCOVERY CONFIGURATION
# =============================================================================
# AWS Eureka server connection - uses private IP for internal communication
# Why needed: Eureka server runs on different EC2 instance with private IP
eureka.client.service-url.defaultZone=http://${EUREKA_PRIVATE_IP}:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true
# Instance ID includes private IP for uniqueness in AWS environment
eureka.instance.instance-id=${spring.application.name}:${EC2_PRIVATE_IP}:${server.port}

# =============================================================================
# FLYWAY CONFIGURATION
# =============================================================================
# ENABLED - Entity Service is the SINGLE SOURCE OF TRUTH for all migrations
# Why needed: Only Entity Service should run database migrations to prevent conflicts
spring.flyway.enabled=true
spring.flyway.url=jdbc:mysql://${RDS_ENDPOINT}:3306/Uber_Db_Prod
spring.flyway.user=${RDS_USERNAME}
spring.flyway.password=${RDS_PASSWORD}
spring.flyway.validate-on-migrate=true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# CloudWatch-compatible logging with file output
# Why needed: AWS CloudWatch agent reads from these log files
logging.file.name=/var/log/uber-services/entity.log
logging.level.org.springframework.data=INFO
logging.level.org.flywaydb=INFO

# =============================================================================
# ACTUATOR CONFIGURATION
# =============================================================================
# Health checks for monitoring
# Why needed: Monitoring systems use /actuator/health
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always